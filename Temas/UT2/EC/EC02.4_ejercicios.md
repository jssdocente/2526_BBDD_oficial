#  EC02.4 Ejercicios Agregaciones

La agregaci贸n es un concepto avanzado en el modelado de datos que nos permite representar relaciones entre entidades de una manera m谩s intuitiva y manejable, especialmente cuando esas relaciones involucran a otras relaciones.

A veces, una relaci贸n entre dos o m谩s entidades se convierte en un "evento" o un "concepto" tan importante por s铆 mismo, que necesitamos que otras entidades se relacionen _con ese evento en su totalidad_. Intentar modelar esto con relaciones de grado superior (ternarias, cuaternarias) a menudo resulta ambiguo y confuso.

La agregaci贸n es la soluci贸n elegante. Nos permite "encapsular" o "empaquetar" una relaci贸n y sus entidades participantes en una caja conceptual, trat谩ndola como si fuera una 煤nica entidad de nivel superior.

**La Regla de Oro de la Agregaci贸n:** Se usa cuando necesitamos modelar una relaci贸n que conecta una entidad con _otra relaci贸n_.

---

### **Ejercicio 1: El Patrocinio Deportivo (Nivel F谩cil)**

Este es el ejemplo cl谩sico para entender la necesidad de la agregaci贸n.

- **Enunciado:**
  En una base de datos de una liga deportiva, se gestionan **JUGADORES**, **EQUIPOS** y **PATROCINADORES**.

  1.  Cada jugador tiene un ID y un nombre. Cada equipo tiene un ID y un nombre.
  2.  Un jugador pertenece a un 煤nico equipo en un momento dado, y un equipo tiene muchos jugadores.
  3.  Una empresa patrocinadora (de la que se conoce su CIF y nombre) quiere firmar contratos de patrocinio. El contrato no es con el jugador a secas, ni con el equipo a secas. El patrocinio es para un **jugador concreto mientras forma parte de un equipo espec铆fico**. Por ejemplo, "Nike patrocina a Cristiano Ronaldo en el Al-Nassr". De este patrocinio se guarda la fecha de inicio y la cuant铆a econ贸mica.

- **Pistas para el alumno:**
  - Primero, modela la relaci贸n entre `JUGADOR` y `EQUIPO`.
  - Ahora, piensa: 驴con qu茅 se relaciona el `PATROCINADOR`? 驴Con `JUGADOR`? 驴Con `EQUIPO`? 驴O con el "fichaje" que une a ambos?
  - Dibuja una caja alrededor de la relaci贸n "pertenece a" y las entidades que une. Esa caja es tu nueva "super-entidad" con la que se relacionar谩 `PATROCINADOR`.

---

### **Ejercicio 2: Supervisi贸n de Proyectos (Nivel Intermedio)**

Aqu铆, la relaci贸n que agregamos es un poco m谩s compleja (N:M), lo que hace que el "evento" sea m谩s evidente.

- **Enunciado:**
  Una consultora de ingenier铆a gestiona los proyectos en los que trabajan sus empleados.

  1.  Se tiene informaci贸n de los **EMPLEADOS** (ID, nombre, cargo) y de los **PROYECTOS** (c贸digo, descripci贸n).
  2.  Un empleado puede trabajar en varios proyectos, y un proyecto tiene varios empleados asignados. Al asignar un empleado a un proyecto, se registra el n煤mero de horas semanales que le dedica.
  3.  Para garantizar la calidad, la empresa contrata a **AUDITORES EXTERNOS** (identificados por su NIF y nombre).
  4.  Un auditor no supervisa a un empleado en general, ni un proyecto en su totalidad. Su trabajo consiste en auditar **la labor espec铆fica que un empleado realiza para un proyecto concreto**. De esta auditor铆a se guarda una fecha y un veredicto ('Aprobado', 'Rechazado').

---

### **Ejercicio 3: Certificaci贸n de Calidad con Jerarqu铆a (Nivel Intermedio-Alto)**

Este ejercicio combina lo que hemos aprendido sobre jerarqu铆as con el nuevo concepto de agregaci贸n.

- **Enunciado:**
  Una empresa de fabricaci贸n quiere controlar la calidad de las piezas que recibe de sus proveedores para sus distintas l铆neas de montaje.

  1.  La empresa trabaja con **PROVEEDORES** (CIF, raz贸n social) y gestiona un inventario de **PIEZAS** (c贸digo, nombre). Un proveedor puede suministrar muchas piezas y una pieza puede ser suministrada por varios proveedores. De cada suministro se conoce el precio unitario al que ese proveedor vende esa pieza.
  2.  El personal de la empresa se registra en la entidad **EMPLEADO** (ID, nombre). Todo empleado es o **INGENIERO** o **INSPECTOR DE CALIDAD** (son roles exclusivos). De los ingenieros se guarda su especialidad y de los inspectores, su nivel de certificaci贸n (Junior, Senior).
  3.  Un inspector de calidad debe emitir un **CERTIFICADO** para el suministro de una pieza por parte de un proveedor espec铆fico. El certificado, que tiene un c贸digo y una fecha de emisi贸n, valida que el precio y la calidad de esa pieza, para ese proveedor, son correctos.
